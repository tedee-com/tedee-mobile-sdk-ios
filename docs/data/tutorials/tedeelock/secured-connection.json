{"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/tutorials\/tedeelock\/secured-connection"]}],"sections":[{"title":"Secured Connection","kind":"hero","chapter":"Secured connection with lock","content":[{"type":"paragraph","inlineContent":[{"text":"Here we will make secured connection to the added and registered lock.","type":"text"}]}]},{"kind":"tasks","tasks":[{"title":"Device Certificate","anchor":"Device-Certificate","contentSection":[{"kind":"contentAndMedia","content":[{"inlineContent":[{"text":"We need to get certificate for this lock from Tedee API","type":"text"}],"type":"paragraph"}],"mediaPosition":"trailing"}],"stepsSection":[{"type":"step","runtimePreview":null,"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Get previously saved mobile id."}]}],"caption":[{"inlineContent":[{"type":"text","text":"We will pass to this function device id that we get in a response from add lock request."}],"type":"paragraph"}],"media":null,"code":"secured_connection_01.swift"},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Prepare and send request."}]}],"runtimePreview":"certificate_response.png","media":null,"code":"secured_connection_02.swift","type":"step","caption":[]},{"type":"step","media":null,"caption":[],"code":"secured_connection_03.swift","content":[{"type":"paragraph","inlineContent":[{"text":"Extract certificate and return TedeeCertificate.","type":"text"}]}],"runtimePreview":null}]},{"title":"Secured connection","anchor":"Secured-connection","stepsSection":[{"code":"secured_connection_04.swift","caption":[],"media":null,"runtimePreview":null,"content":[{"inlineContent":[{"text":"With the certificate, we can make secured connection.","type":"text"}],"type":"paragraph"}],"type":"step"}],"contentSection":[{"content":[{"inlineContent":[{"type":"text","text":"Now, we can make secured connection to the lock."}],"type":"paragraph"}],"kind":"contentAndMedia","mediaPosition":"trailing"}]}]},{"featuredEyebrow":"Tutorial","abstract":[{"type":"text","text":"Here we will combine all the set up and functions that we prepared previously to achieve add lock flow."}],"action":{"overridingTitle":"Get started","isActive":true,"type":"reference","identifier":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/summary","overridingTitleInlineContent":[{"text":"Get started","type":"text"}]},"kind":"callToAction","title":"Summary"}],"metadata":{"categoryPathComponent":"Tutorial-Table-of-Contents","title":"Secured Connection","role":"project","category":"How to add Lock"},"kind":"project","hierarchy":{"paths":[["doc:\/\/TedeeLock\/tutorials\/Tutorial-Table-of-Contents","doc:\/\/TedeeLock\/tutorials\/Tutorial-Table-of-Contents\/$volume","doc:\/\/TedeeLock\/tutorials\/Tutorial-Table-of-Contents\/Secured-connection-with-lock"]],"modules":[{"reference":"doc:\/\/TedeeLock\/tutorials\/Tutorial-Table-of-Contents\/Before-You-start","projects":[{"sections":[{"reference":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/requirements#Tedee-Pro-or-Tedee-GO","kind":"task"},{"reference":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/requirements#Activation-code","kind":"task"},{"reference":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/requirements#Tedee-account","kind":"task"}],"reference":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/requirements"},{"reference":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/api-set-up","sections":[{"kind":"task","reference":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/api-set-up#API-configuration"}]}]},{"reference":"doc:\/\/TedeeLock\/tutorials\/Tutorial-Table-of-Contents\/Connect-and-get-lock-data","projects":[{"sections":[{"reference":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/unsecured-connection#Registering-mobile","kind":"task"},{"kind":"task","reference":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/unsecured-connection#Serial-number"},{"kind":"task","reference":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/unsecured-connection#Unsecured-connection"}],"reference":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/unsecured-connection"},{"reference":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/get-lock-data","sections":[{"kind":"task","reference":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/get-lock-data#Provide-Signed-date-time"},{"reference":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/get-lock-data#Get-lock-data","kind":"task"}]}]},{"projects":[{"reference":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/add-lock","sections":[{"reference":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/add-lock#%3Ctext%3E","kind":"task"}]},{"sections":[{"kind":"task","reference":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/register-lock#%3Ctext%3E"}],"reference":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/register-lock"}],"reference":"doc:\/\/TedeeLock\/tutorials\/Tutorial-Table-of-Contents\/Add-lock-to-Tedee-account"},{"reference":"doc:\/\/TedeeLock\/tutorials\/Tutorial-Table-of-Contents\/Secured-connection-with-lock","projects":[{"reference":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/secured-connection","sections":[{"reference":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/secured-connection#Device-Certificate","kind":"task"},{"reference":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/secured-connection#Secured-connection","kind":"task"}]}]},{"projects":[{"reference":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/summary","sections":[{"kind":"task","reference":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/summary#Summary"}]}],"reference":"doc:\/\/TedeeLock\/tutorials\/Tutorial-Table-of-Contents\/Summary"}],"reference":"doc:\/\/TedeeLock\/tutorials\/Tutorial-Table-of-Contents"},"identifier":{"url":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/secured-connection","interfaceLanguage":"swift"},"schemaVersion":{"patch":0,"major":0,"minor":3},"references":{"doc://TedeeLock/tutorials/TedeeLock/summary#Summary":{"abstract":[{"text":"Here we will combine all the set up and functions that we prepared previously to achieve add lock flow.","type":"text"}],"type":"section","kind":"section","title":"Summary","role":"pseudoSymbol","url":"\/tutorials\/tedeelock\/summary#Summary","identifier":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/summary#Summary"},"doc://TedeeLock/tutorials/TedeeLock/requirements#Tedee-account":{"abstract":[{"text":"Here are all the requirements that you need to prepare to be able to complete this tutorial.","type":"text"}],"type":"section","kind":"section","title":"Tedee account","role":"pseudoSymbol","url":"\/tutorials\/tedeelock\/requirements#Tedee-account","identifier":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/requirements#Tedee-account"},"doc://TedeeLock/tutorials/TedeeLock/api-set-up#API-configuration":{"abstract":[{"text":"Here we will configure ","type":"text"},{"type":"reference","identifier":"https:\/\/api.tedee.com\/swagger\/index.html","isActive":true},{"text":" in a way that will be easy to use in next chapters.","type":"text"}],"type":"section","kind":"section","title":"API configuration","role":"pseudoSymbol","url":"\/tutorials\/tedeelock\/api-set-up#API-configuration","identifier":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/api-set-up#API-configuration"},"doc://TedeeLock/tutorials/Tutorial-Table-of-Contents":{"kind":"overview","identifier":"doc:\/\/TedeeLock\/tutorials\/Tutorial-Table-of-Contents","type":"topic","title":"How to add Lock","role":"overview","url":"\/tutorials\/tutorial-table-of-contents","abstract":[{"text":"This tutorial will show you basic steps that are needed in order to add lock to Tedee account, register the lock device and securely connect to it.","type":"text"}]},"https://api.tedee.com/swagger/index.html":{"title":"Tedee API","type":"link","url":"https:\/\/api.tedee.com\/swagger\/index.html","identifier":"https:\/\/api.tedee.com\/swagger\/index.html","titleInlineContent":[{"type":"text","text":"Tedee API"}]},"doc://TedeeLock/tutorials/TedeeLock/get-lock-data#Get-lock-data":{"abstract":[{"text":"Here we will get all necessary data from lock, that are required to create add lock to your account.","type":"text"}],"type":"section","kind":"section","title":"Get lock data","role":"pseudoSymbol","url":"\/tutorials\/tedeelock\/get-lock-data#Get-lock-data","identifier":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/get-lock-data#Get-lock-data"},"doc://TedeeLock/tutorials/TedeeLock/unsecured-connection#Serial-number":{"abstract":[{"text":"Here we will register mobile in Tedee API, we will get serial number of the lock from activation code and then we will make unsecured connection to the lock that we want to add.","type":"text"}],"type":"section","identifier":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/unsecured-connection#Serial-number","title":"Serial number ","role":"pseudoSymbol","url":"\/tutorials\/tedeelock\/unsecured-connection#Serial-number","kind":"section"},"certificate_response.png":{"alt":"Certificate response","variants":[{"url":"\/images\/certificate_response.png","traits":["1x","light"]}],"type":"image","identifier":"certificate_response.png"},"doc://TedeeLock/tutorials/TedeeLock/requirements#Tedee-Pro-or-Tedee-GO":{"role":"pseudoSymbol","identifier":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/requirements#Tedee-Pro-or-Tedee-GO","type":"section","abstract":[{"text":"Here are all the requirements that you need to prepare to be able to complete this tutorial.","type":"text"}],"url":"\/tutorials\/tedeelock\/requirements#Tedee-Pro-or-Tedee-GO","kind":"section","title":"Tedee Pro or Tedee GO"},"secured_connection_01.swift":{"content":["import Foundation","import TedeeLock","","class AddLock {","    func getCertificate(deviceId: Int) async -> TedeeCertificate {","        let mobileId = UserDefaults.standard.string(forKey: \"TedeeMobileId\")!","    }","}"],"type":"file","fileName":"addLock.swift","highlights":[],"fileType":"swift","syntax":"swift","identifier":"secured_connection_01.swift"},"doc://TedeeLock/tutorials/TedeeLock/summary":{"abstract":[{"text":"Here we will combine all the set up and functions that we prepared previously to achieve add lock flow.","type":"text"}],"role":"project","identifier":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/summary","type":"topic","title":"Summary","url":"\/tutorials\/tedeelock\/summary","kind":"project"},"doc://TedeeLock/tutorials/TedeeLock/api-set-up":{"kind":"project","identifier":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/api-set-up","type":"topic","title":"API set up","role":"project","url":"\/tutorials\/tedeelock\/api-set-up","abstract":[{"text":"Here we will configure ","type":"text"},{"type":"reference","identifier":"https:\/\/api.tedee.com\/swagger\/index.html","isActive":true},{"text":" in a way that will be easy to use in next chapters.","type":"text"}]},"doc://TedeeLock/tutorials/Tutorial-Table-of-Contents/Before-You-start":{"kind":"article","identifier":"doc:\/\/TedeeLock\/tutorials\/Tutorial-Table-of-Contents\/Before-You-start","type":"topic","title":"Before You start","role":"article","url":"\/tutorials\/tutorial-table-of-contents\/before-you-start","abstract":[]},"doc://TedeeLock/tutorials/Tutorial-Table-of-Contents/Summary":{"kind":"article","identifier":"doc:\/\/TedeeLock\/tutorials\/Tutorial-Table-of-Contents\/Summary","type":"topic","title":"Summary","role":"article","url":"\/tutorials\/tutorial-table-of-contents\/summary","abstract":[]},"doc://TedeeLock/tutorials/TedeeLock/requirements#Activation-code":{"kind":"section","title":"Activation code","url":"\/tutorials\/tedeelock\/requirements#Activation-code","identifier":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/requirements#Activation-code","role":"pseudoSymbol","abstract":[{"type":"text","text":"Here are all the requirements that you need to prepare to be able to complete this tutorial."}],"type":"section"},"doc://TedeeLock/tutorials/TedeeLock/secured-connection#Secured-connection":{"kind":"section","identifier":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/secured-connection#Secured-connection","type":"section","title":"Secured connection","role":"pseudoSymbol","url":"\/tutorials\/tedeelock\/secured-connection#Secured-connection","abstract":[{"text":"Here we will make secured connection to the added and registered lock.","type":"text"}]},"doc://TedeeLock/tutorials/TedeeLock/register-lock#%3Ctext%3E":{"kind":"section","identifier":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/register-lock#%3Ctext%3E","type":"section","title":"<#text#>","role":"pseudoSymbol","url":"\/tutorials\/tedeelock\/register-lock#%253Ctext%253E","abstract":[{"text":"Here we will register the lock, this is required to made secured connection later.","type":"text"}]},"doc://TedeeLock/tutorials/Tutorial-Table-of-Contents/Secured-connection-with-lock":{"abstract":[],"role":"article","identifier":"doc:\/\/TedeeLock\/tutorials\/Tutorial-Table-of-Contents\/Secured-connection-with-lock","type":"topic","title":"Secured connection with lock","url":"\/tutorials\/tutorial-table-of-contents\/secured-connection-with-lock","kind":"article"},"doc://TedeeLock/tutorials/TedeeLock/get-lock-data":{"abstract":[{"text":"Here we will get all necessary data from lock, that are required to create add lock to your account.","type":"text"}],"type":"topic","kind":"project","title":"Get Lock data","role":"project","url":"\/tutorials\/tedeelock\/get-lock-data","identifier":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/get-lock-data"},"doc://TedeeLock/tutorials/Tutorial-Table-of-Contents/Add-lock-to-Tedee-account":{"kind":"article","identifier":"doc:\/\/TedeeLock\/tutorials\/Tutorial-Table-of-Contents\/Add-lock-to-Tedee-account","type":"topic","title":"Add lock to Tedee account","role":"article","url":"\/tutorials\/tutorial-table-of-contents\/add-lock-to-tedee-account","abstract":[]},"doc://TedeeLock/tutorials/TedeeLock/secured-connection#Device-Certificate":{"kind":"section","identifier":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/secured-connection#Device-Certificate","type":"section","title":"Device Certificate","role":"pseudoSymbol","url":"\/tutorials\/tedeelock\/secured-connection#Device-Certificate","abstract":[{"text":"Here we will make secured connection to the added and registered lock.","type":"text"}]},"doc://TedeeLock/tutorials/TedeeLock/secured-connection":{"abstract":[{"text":"Here we will make secured connection to the added and registered lock.","type":"text"}],"type":"topic","kind":"project","title":"Secured Connection","role":"project","url":"\/tutorials\/tedeelock\/secured-connection","identifier":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/secured-connection"},"doc://TedeeLock/tutorials/TedeeLock/unsecured-connection":{"role":"project","type":"topic","kind":"project","estimatedTime":"10min","identifier":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/unsecured-connection","title":"Unsecured Connection","url":"\/tutorials\/tedeelock\/unsecured-connection","abstract":[{"type":"text","text":"Here we will register mobile in Tedee API, we will get serial number of the lock from activation code and then we will make unsecured connection to the lock that we want to add."}]},"doc://TedeeLock/tutorials/TedeeLock/add-lock":{"abstract":[{"text":"Here wi will add the lock to Tedee account via Tedee API","type":"text"}],"role":"project","identifier":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/add-lock","type":"topic","title":"Add Lock","url":"\/tutorials\/tedeelock\/add-lock","kind":"project"},"doc://TedeeLock/tutorials/TedeeLock/register-lock":{"kind":"project","title":"Register Lock","abstract":[{"text":"Here we will register the lock, this is required to made secured connection later.","type":"text"}],"identifier":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/register-lock","role":"project","url":"\/tutorials\/tedeelock\/register-lock","type":"topic"},"doc://TedeeLock/tutorials/TedeeLock/requirements":{"abstract":[{"text":"Here are all the requirements that you need to prepare to be able to complete this tutorial.","type":"text"}],"type":"topic","kind":"project","title":"Requirements","role":"project","url":"\/tutorials\/tedeelock\/requirements","identifier":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/requirements"},"doc://TedeeLock/tutorials/Tutorial-Table-of-Contents/Connect-and-get-lock-data":{"kind":"article","identifier":"doc:\/\/TedeeLock\/tutorials\/Tutorial-Table-of-Contents\/Connect-and-get-lock-data","type":"topic","title":"Connect and get lock data","role":"article","url":"\/tutorials\/tutorial-table-of-contents\/connect-and-get-lock-data","abstract":[]},"secured_connection_04.swift":{"fileName":"addLock.swift","syntax":"swift","type":"file","content":["import Foundation","import TedeeLock","","class AddLock {","    func securedConnection(serialNumber: TedeeSerialNumber, certificate: TedeeCertificate) async {","        try! await TedeeLockManager.shared.connect(serialNumber, certificate: certificate)","    }","}"],"fileType":"swift","highlights":[],"identifier":"secured_connection_04.swift"},"secured_connection_02.swift":{"identifier":"secured_connection_02.swift","highlights":[{"line":7},{"line":8},{"line":9},{"line":10},{"line":11},{"line":12},{"line":13},{"line":14}],"fileName":"addLock.swift","fileType":"swift","type":"file","content":["import Foundation","import TedeeLock","","class AddLock {","    func getCertificate(deviceId: Int) async -> TedeeCertificate {","        let mobileId = UserDefaults.standard.string(forKey: \"TedeeMobileId\")!","        ","        let requestURL = URL(string: \"https:\/\/api.tedee.com\/api\/v1.32\/my\/devicecertificate\/getformobile?MobileId=\\(mobileId)&DeviceId=\\(deviceId)\")!","        var request = URLRequest(url: requestURL)","        request.httpMethod = \"GET\"","        request.addValue(\"application\/json\", forHTTPHeaderField: \"accept\")","        request.addValue(\"PersonalKey \\(pat)\", forHTTPHeaderField: \"Authorization\")","        ","        let response = try! await URLSession.shared.data(for: request)","    }","}"],"syntax":"swift"},"doc://TedeeLock/tutorials/TedeeLock/unsecured-connection#Registering-mobile":{"kind":"section","identifier":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/unsecured-connection#Registering-mobile","type":"section","title":"Registering mobile","role":"pseudoSymbol","url":"\/tutorials\/tedeelock\/unsecured-connection#Registering-mobile","abstract":[{"text":"Here we will register mobile in Tedee API, we will get serial number of the lock from activation code and then we will make unsecured connection to the lock that we want to add.","type":"text"}]},"doc://TedeeLock/tutorials/TedeeLock/get-lock-data#Provide-Signed-date-time":{"abstract":[{"text":"Here we will get all necessary data from lock, that are required to create add lock to your account.","type":"text"}],"type":"section","kind":"section","title":"Provide Signed date time","role":"pseudoSymbol","url":"\/tutorials\/tedeelock\/get-lock-data#Provide-Signed-date-time","identifier":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/get-lock-data#Provide-Signed-date-time"},"doc://TedeeLock/tutorials/TedeeLock/unsecured-connection#Unsecured-connection":{"kind":"section","title":"Unsecured connection","url":"\/tutorials\/tedeelock\/unsecured-connection#Unsecured-connection","identifier":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/unsecured-connection#Unsecured-connection","role":"pseudoSymbol","abstract":[{"type":"text","text":"Here we will register mobile in Tedee API, we will get serial number of the lock from activation code and then we will make unsecured connection to the lock that we want to add."}],"type":"section"},"doc://TedeeLock/tutorials/TedeeLock/add-lock#%3Ctext%3E":{"abstract":[{"text":"Here wi will add the lock to Tedee account via Tedee API","type":"text"}],"type":"section","kind":"section","title":"<#text#>","role":"pseudoSymbol","url":"\/tutorials\/tedeelock\/add-lock#%253Ctext%253E","identifier":"doc:\/\/TedeeLock\/tutorials\/TedeeLock\/add-lock#%3Ctext%3E"},"secured_connection_03.swift":{"fileName":"addLock.swift","content":["import Foundation","import TedeeLock","","class AddLock {","    func getCertificate(deviceId: Int) async -> TedeeCertificate {","        let mobileId = UserDefaults.standard.string(forKey: \"TedeeMobileId\")!","        ","        let requestURL = URL(string: \"https:\/\/api.tedee.com\/api\/v1.32\/my\/devicecertificate\/getformobile?MobileId=\\(mobileId)&DeviceId=\\(deviceId)\")!","        var request = URLRequest(url: requestURL)","        request.httpMethod = \"GET\"","        request.addValue(\"application\/json\", forHTTPHeaderField: \"accept\")","        request.addValue(\"PersonalKey \\(pat)\", forHTTPHeaderField: \"Authorization\")","        ","        let response = try! await URLSession.shared.data(for: request)","        ","        let responseDictionary = try! JSONSerialization.jsonObject(with: response.0) as! [String: Any]","        let result = responseDictionary[\"result\"] as! [String: String]","        ","        let dF = DateFormatter()","        dF.dateFormat = \"yyyy-MM-dd'T'HH:mm:ss.SSSSSSS'Z'\"","        dF.locale = Locale(identifier: \"en_US_POSIX\")","        dF.timeZone = TimeZone(abbreviation: \"UTC\")","        let expirationDate = dF.date(from: result[\"expirationDate\"]!)","        ","        return try! TedeeCertificate(certificate: result[\"certificate\"]!,","                                     expirationDate: expirationDate!,","                                     devicePublicKey: result[\"devicePublicKey\"]!,","                                     mobilePublicKey: result[\"mobilePublicKey\"]!)","    }","}"],"fileType":"swift","syntax":"swift","highlights":[{"line":15},{"line":16},{"line":17},{"line":18},{"line":19},{"line":20},{"line":21},{"line":22},{"line":23},{"line":24},{"line":25},{"line":26},{"line":27},{"line":28}],"type":"file","identifier":"secured_connection_03.swift"}}}